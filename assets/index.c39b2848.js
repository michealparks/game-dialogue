var ze=Object.defineProperty;var be=Object.getOwnPropertySymbols;var Qe=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ke=(t,e,n)=>e in t?ze(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V=(t,e)=>{for(var n in e||(e={}))Qe.call(e,n)&&ke(t,n,e[n]);if(be)for(var n of be(e))Xe.call(e,n)&&ke(t,n,e[n]);return t};const Ze=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}};Ze();const et="modulepreload",_e={},tt="/game-dialogue/",nt=function(e,n){return!n||n.length===0?e():Promise.all(n.map(o=>{if(o=`${tt}${o}`,o in _e)return;_e[o]=!0;const s=o.endsWith(".css"),r=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${r}`))return;const i=document.createElement("link");if(i.rel=s?"stylesheet":et,s||(i.as="script",i.crossOrigin=""),i.href=o,document.head.appendChild(i),s)return new Promise((a,u)=>{i.addEventListener("load",a),i.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e())};function M(){}function ot(t,e){for(const n in e)t[n]=e[n];return t}function Je(t){return t()}function ve(){return Object.create(null)}function J(t){t.forEach(Je)}function Ne(t){return typeof t=="function"}function te(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let z;function ee(t,e){return z||(z=document.createElement("a")),z.href=e,t===z.href}function st(t){return Object.keys(t).length===0}function Ie(t){return t==null?"":t}function rt(t){return t&&Ne(t.destroy)?t.destroy:M}function v(t,e){t.appendChild(e)}function S(t,e,n){t.insertBefore(e,n||null)}function E(t){t.parentNode.removeChild(t)}function I(t){return document.createElement(t)}function K(t){return document.createTextNode(t)}function F(){return K(" ")}function at(){return K("")}function ae(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function P(t,e,n){e in t?t[e]=typeof t[e]=="boolean"&&n===""?!0:n:b(t,e,n)}function it(t){return Array.from(t.childNodes)}function le(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function xe(t,e){t.value=e==null?"":e}function Ae(t,e,n){t.classList[n?"add":"remove"](e)}function lt(t,e,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,!1,e),o}class ut{constructor(){this.e=this.n=null}c(e){this.h(e)}m(e,n,o=null){this.e||(this.e=I(n.nodeName),this.t=n,this.c(e)),this.i(o)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)S(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(E)}}let Y;function U(t){Y=t}function ft(){if(!Y)throw new Error("Function called outside component initialization");return Y}function ht(){const t=ft();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const s=lt(e,n);o.slice().forEach(r=>{r.call(t,s)})}}}const q=[],ue=[],X=[],Te=[],ct=Promise.resolve();let fe=!1;function dt(){fe||(fe=!0,ct.then(Ce))}function he(t){X.push(t)}const ie=new Set;let Q=0;function Ce(){const t=Y;do{for(;Q<q.length;){const e=q[Q];Q++,U(e),mt(e.$$)}for(U(null),q.length=0,Q=0;ue.length;)ue.pop()();for(let e=0;e<X.length;e+=1){const n=X[e];ie.has(n)||(ie.add(n),n())}X.length=0}while(q.length);for(;Te.length;)Te.pop()();fe=!1,ie.clear(),U(t)}function mt(t){if(t.fragment!==null){t.update(),J(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(he)}}const Z=new Set;let H;function Be(){H={r:0,c:[],p:H}}function Ee(){H.r||J(H.c),H=H.p}function L(t,e){t&&t.i&&(Z.delete(t),t.i(e))}function O(t,e,n,o){if(t&&t.o){if(Z.has(t))return;Z.add(t),H.c.push(()=>{Z.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}function gt(t,e){O(t,1,1,()=>{e.delete(t.key)})}function pt(t,e,n,o,s,r,i,a,u,c,y,l){let h=t.length,f=r.length,d=h;const w={};for(;d--;)w[t[d].key]=d;const p=[],_=new Map,m=new Map;for(d=f;d--;){const k=l(s,r,d),A=n(k);let T=i.get(A);T?o&&T.p(k,e):(T=c(A,k),T.c()),_.set(A,p[d]=T),A in w&&m.set(A,Math.abs(d-w[A]))}const x=new Set,W=new Set;function N(k){L(k,1),k.m(a,y),i.set(k.key,k),y=k.first,f--}for(;h&&f;){const k=p[f-1],A=t[h-1],T=k.key,g=A.key;k===A?(y=k.first,h--,f--):_.has(g)?!i.has(T)||x.has(T)?N(k):W.has(g)?h--:m.get(T)>m.get(g)?(W.add(T),N(k)):(x.add(g),h--):(u(A,i),h--)}for(;h--;){const k=t[h];_.has(k.key)||u(k,i)}for(;f;)N(p[f-1]);return p}function wt(t,e){const n={},o={},s={$$scope:1};let r=t.length;for(;r--;){const i=t[r],a=e[r];if(a){for(const u in i)u in a||(o[u]=1);for(const u in a)s[u]||(n[u]=a[u],s[u]=1);t[r]=a}else for(const u in i)s[u]=1}for(const i in o)i in n||(n[i]=void 0);return n}function yt(t){return typeof t=="object"&&t!==null?t:{}}function ne(t){t&&t.c()}function D(t,e,n,o){const{fragment:s,on_mount:r,on_destroy:i,after_update:a}=t.$$;s&&s.m(e,n),o||he(()=>{const u=r.map(Je).filter(Ne);i?i.push(...u):J(u),t.$$.on_mount=[]}),a.forEach(he)}function G(t,e){const n=t.$$;n.fragment!==null&&(J(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function bt(t,e){t.$$.dirty[0]===-1&&(q.push(t),dt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function oe(t,e,n,o,s,r,i,a=[-1]){const u=Y;U(t);const c=t.$$={fragment:null,ctx:null,props:r,update:M,not_equal:s,bound:ve(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:ve(),dirty:a,skip_bound:!1,root:e.target||u.$$.root};i&&i(c.root);let y=!1;if(c.ctx=n?n(t,e.props||{},(l,h,...f)=>{const d=f.length?f[0]:h;return c.ctx&&s(c.ctx[l],c.ctx[l]=d)&&(!c.skip_bound&&c.bound[l]&&c.bound[l](d),y&&bt(t,l)),h}):[],c.update(),y=!0,J(c.before_update),c.fragment=o?o(c.ctx):!1,e.target){if(e.hydrate){const l=it(e.target);c.fragment&&c.fragment.l(l),l.forEach(E)}else c.fragment&&c.fragment.c();e.intro&&L(t.$$.fragment),D(t,e.target,e.anchor,e.customElement),Ce()}U(u)}class se{$destroy(){G(this,1),this.$destroy=M}$on(e,n){const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const s=o.indexOf(n);s!==-1&&o.splice(s,1)}}$set(e){this.$$set&&!st(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function kt(t){let e,n,o,s,r,i;return{c(){e=I("input-box"),n=I("input"),o=F(),s=I("button"),s.innerHTML='<svg viewBox="0 0 24 24" class="w-6 h-6" style="stroke: #555; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; fill: none; "><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>',b(n,"class","h-full w-[calc(100vw-3rem)] p-3.5 m-0 border-0 bg-transparent outline-none"),b(n,"type","text"),b(n,"placeholder","Send a message"),b(s,"aria-label","Send message"),b(s,"class","grid place-content-center h-full w-12 p-0 border-0 bg-transparent outline-none"),P(e,"class","fixed bottom-0 left-0 flex h-12 w-full bg-white")},m(a,u){S(a,e,u),v(e,n),t[4](n),xe(n,t[1]),v(e,o),v(e,s),r||(i=[ae(n,"input",t[5]),ae(n,"keyup",t[2]),ae(s,"click",t[3])],r=!0)},p(a,[u]){u&2&&n.value!==a[1]&&xe(n,a[1])},i:M,o:M,d(a){a&&E(e),t[4](null),r=!1,J(i)}}}function _t(t,e,n){const o=ht();let s,r="";const i=l=>{l.key==="Enter"&&u()},a=()=>{u()},u=()=>{r!==""&&(o("input",{value:r}),n(1,r=""))};function c(l){ue[l?"unshift":"push"](()=>{s=l,n(0,s)})}function y(){r=this.value,n(1,r)}return[s,r,i,a,c,y]}class vt extends se{constructor(e){super();oe(this,e,_t,kt,te,{})}}const $=(...t)=>{const e=[];for(const n of t){if(!n)continue;const o=typeof n;if(o==="string")e.push(n);else if(o==="object")for(const[s,r]of Object.entries(n))r&&e.push(s)}return e.join(" ")},It=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}),je=t=>{try{return It.format(t)}catch{return""}};function Fe(t){let e,n,o;return{c(){e=I("img"),b(e,"class","block w-full rounded-md"),b(e,"alt",n=t[4].description),ee(e.src,o=t[4].src)||b(e,"src",o)},m(s,r){S(s,e,r)},p(s,r){r&16&&n!==(n=s[4].description)&&b(e,"alt",n),r&16&&!ee(e.src,o=s[4].src)&&b(e,"src",o)},d(s){s&&E(e)}}}function Le(t){let e;return{c(){e=I("message-text"),e.innerHTML=`<message-dot class="w-2.5 h-2.5 rounded bg-gray-200 svelte-d4stmd"></message-dot> 
        <message-dot class="w-2.5 h-2.5 rounded bg-gray-200 svelte-d4stmd"></message-dot> 
        <message-dot class="w-2.5 h-2.5 rounded bg-gray-200 svelte-d4stmd"></message-dot>`,P(e,"class","flex gap-1")},m(n,o){S(n,e,o)},d(n){n&&E(e)}}}function Se(t){let e,n;return{c(){e=I("div"),b(e,"class",n=$("absolute bottom-0 w-0 h-0 border-solid",{"-right-2 border-0 border-t-8 border-l-8 border-l-blue-200 border-t-transparent":t[1],"-left-2 border-b-8 border-l-8 border-b-gray-50 border-l-transparent":!t[1]}))},m(o,s){S(o,e,s)},p(o,s){s&2&&n!==(n=$("absolute bottom-0 w-0 h-0 border-solid",{"-right-2 border-0 border-t-8 border-l-8 border-l-blue-200 border-t-transparent":o[1],"-left-2 border-b-8 border-l-8 border-b-gray-50 border-l-transparent":!o[1]}))&&b(e,"class",n)},d(o){o&&E(e)}}}function Oe(t){let e,n,o,s,r,i,a,u=t[6].title+"",c,y,l,h=new URL(t[6].href).hostname+"",f,d;return{c(){e=I("a"),n=I("img"),r=F(),i=I("div"),a=I("small"),c=K(u),y=F(),l=I("small"),f=K(h),b(n,"class","block w-full rounded-t-md"),b(n,"alt",o=t[6].img.description),ee(n.src,s=t[6].img.src)||b(n,"src",s),b(l,"class","text-gray-500"),b(i,"class","flex flex-col p-2"),b(e,"target","_tab"),b(e,"href",d=t[6].href)},m(w,p){S(w,e,p),v(e,n),v(e,r),v(e,i),v(i,a),v(a,c),v(i,y),v(i,l),v(l,f)},p(w,p){p&64&&o!==(o=w[6].img.description)&&b(n,"alt",o),p&64&&!ee(n.src,s=w[6].img.src)&&b(n,"src",s),p&64&&u!==(u=w[6].title+"")&&le(c,u),p&64&&h!==(h=new URL(w[6].href).hostname+"")&&le(f,h),p&64&&d!==(d=w[6].href)&&b(e,"href",d)},d(w){w&&E(e)}}}function Me(t){let e,n=je(t[5])+"",o;return{c(){e=I("time"),o=K(n),b(e,"class","text-xs pt-1 px-4"),Ae(e,"hidden",t[2])},m(s,r){S(s,e,r),v(e,o)},p(s,r){r&32&&n!==(n=je(s[5])+"")&&le(o,n),r&4&&Ae(e,"hidden",s[2])},d(s){s&&E(e)}}}function xt(t){let e,n,o,s,r,i,a,u,c,y,l,h,f=t[4]&&Fe(t),d=t[0]&&Le(),w=!t[2]&&!t[4]&&!t[6]&&Se(t),p=t[6]&&Oe(t),_=!t[0]&&Me(t);return{c(){e=I("message-bubble"),n=I("message-text"),f&&f.c(),o=F(),s=new ut,r=F(),d&&d.c(),i=F(),w&&w.c(),a=F(),p&&p.c(),c=F(),_&&_.c(),s.a=r,P(n,"class",u=$("relative block w-fit max-w-[75%] rounded-md",{"px-4 py-2.5":!t[4]&&!t[6],"shadow-xl":!t[2],"pb-5 text-gray-500":t[2],"bg-blue-200 rounded-br-none":!t[4]&&!t[6]&&t[1],"bg-gray-50 rounded-bl-none":!t[4]&&!t[6]&&!t[2]&&!t[1]})),P(e,"class",y=Ie($("flex flex-col w-full rounded-md",{"origin-bottom-left":!t[1],"items-end origin-bottom-right":t[1]}))+" svelte-d4stmd")},m(m,x){S(m,e,x),v(e,n),f&&f.m(n,null),v(n,o),s.m(t[3],n),v(n,r),d&&d.m(n,null),v(n,i),w&&w.m(n,null),v(n,a),p&&p.m(n,null),v(e,c),_&&_.m(e,null),l||(h=rt(t[7].call(null,e)),l=!0)},p(m,[x]){m[4]?f?f.p(m,x):(f=Fe(m),f.c(),f.m(n,o)):f&&(f.d(1),f=null),x&8&&s.p(m[3]),m[0]?d||(d=Le(),d.c(),d.m(n,i)):d&&(d.d(1),d=null),!m[2]&&!m[4]&&!m[6]?w?w.p(m,x):(w=Se(m),w.c(),w.m(n,a)):w&&(w.d(1),w=null),m[6]?p?p.p(m,x):(p=Oe(m),p.c(),p.m(n,null)):p&&(p.d(1),p=null),x&86&&u!==(u=$("relative block w-fit max-w-[75%] rounded-md",{"px-4 py-2.5":!m[4]&&!m[6],"shadow-xl":!m[2],"pb-5 text-gray-500":m[2],"bg-blue-200 rounded-br-none":!m[4]&&!m[6]&&m[1],"bg-gray-50 rounded-bl-none":!m[4]&&!m[6]&&!m[2]&&!m[1]}))&&P(n,"class",u),m[0]?_&&(_.d(1),_=null):_?_.p(m,x):(_=Me(m),_.c(),_.m(e,null)),x&2&&y!==(y=Ie($("flex flex-col w-full rounded-md",{"origin-bottom-left":!m[1],"items-end origin-bottom-right":m[1]}))+" svelte-d4stmd")&&P(e,"class",y)},i:M,o:M,d(m){m&&E(e),f&&f.d(),d&&d.d(),w&&w.d(),p&&p.d(),_&&_.d(),l=!1,h()}}}function At(t,e,n){let{typing:o=!1}=e,{user:s=!1}=e,{info:r=!1}=e,{value:i=""}=e,{image:a=void 0}=e,{datetime:u=0}=e,{link:c=void 0}=e;const y=l=>{l.scrollIntoView()};return t.$$set=l=>{"typing"in l&&n(0,o=l.typing),"user"in l&&n(1,s=l.user),"info"in l&&n(2,r=l.info),"value"in l&&n(3,i=l.value),"image"in l&&n(4,a=l.image),"datetime"in l&&n(5,u=l.datetime),"link"in l&&n(6,c=l.link)},[o,s,r,i,a,u,c,y]}class qe extends se{constructor(e){super();oe(this,e,At,xt,te,{typing:0,user:1,info:2,value:3,image:4,datetime:5,link:6})}}const We=t=>t===0?Promise.resolve():new Promise(e=>{setTimeout(e,t*1e3)});var ce={variables:{$january:["january","jan","1","01"],$february:["february","feb","2","02"],$march:["march","mar","3","03"],$april:["april","apr","4","04"],$may:["may","5","05"],$november:["november","nov","11"],$december:["december","dec"],$yes:["ready","yes","yep","yeah","okay","yee","yea","yup","ya","I am","indeed","sure","aye","si","of course","certainly","affirmative","OK","oui"],$second:["second","2nd","package"],$third:["third","3rd","package"]},bot:{sleepBefore:2,sleepAfter:1,responses:{incorrect:[{text:"Hmm, I get the feeling that\u2019s not quite right. Try taking another look.",sleepAfter:0},{text:"Hmm, I\u2019m not sure that\u2019s it... Maybe take another look at that.",sleepAfter:0},{text:"That doesn\u2019t seem right, I think you should double check your work.",sleepAfter:0},{text:"Something about that doesn't seem right to me. Try again and let me know what you get.",sleepAfter:0},{text:"I'm not sure if that makes sense. Try looking at it again and let me know what you find.",sleepAfter:0},{text:"Hmm, something tells me that\u2019s not what we\u2019re looking for.",sleepAfter:0}]}},dialogue:[{key:"start",sleepBefore:0,text:"Hello! Welcome to Koschei Society webchat service. To continue, please enter the month of our most recent correspondence.",waitFor:[{sleepBefore:0,answers:["$january","$february","$march","$april","$may","$november","$december"],saveInputAs:"month",sleepAfter:1}],defaultResponses:[{sleepBefore:0,text:"Invalid input. Please enter the month.",sleepAfter:0}]},{sleepBefore:0,text:"Thank you. Please enter your first name to continue.",saveInputAs:"name"},{sleepBefore:0,text:"Connecting to User: Jesse Wright...",info:!0,goto:"$month"},{month:["$january"],sleepBefore:3,sleepAfter:1,text:"Hi {name}! Jesse here, nice to meet you. Thank you for agreeing to help us, we are very happy to have you on board."},{text:"I'm sure you've got a lot of work ahead of you, so I won't take up any of your time."},{sleepBefore:4,sleepAfter:1,text:"Just to confirm, our immediate goal with these documents is to find the names of 3 potion ingredients, and the location of the tunnel entrance. When you have figured out any one of those things, please send them over, one at a time.",waitFor:[{answers:["cathedral","vitus"],text:"Ah, the entrance must be inside the Cathedral of St. Vitus then! Good work.",sleepAfter:0},{answers:["davius"],text:"A truly fascinating species of butterfly. Well done.",sleepAfter:0},{answers:["malachite"],text:"Oh great, you figured out which crystal we need.",sleepAfter:0},{answers:["sambucus"],text:"Good work, now we know we need the Sambucus plant.",sleepAfter:0}]},{text:"Thank you so much, {name}, you clearly have a talent for this."},{sleepBefore:3,text:"If we manage to gain access to the tunnels underneath Prague, I have a strong feeling the answers we\u2019re looking for are in there."},{sleepBefore:4,text:"I\u2019m going to search the cathedral for an entrance and dig around in our archives for any other relevant information. Keep an eye out for another package from us soon, and let me know once you\u2019ve opened it and are ready to continue. Until then, take care.",sleepAfter:4},{sleepBefore:0,text:"Jesse Wright has left the chat. To begin a new session with this user please send a new message or refresh the page.",info:!0,waitForAnyInput:!0},{key:"february",month:["$february"],text:"Hi {name}, great to hear from you again. Did you receive the second package and are ready to continue?",waitFor:[{answers:["$yes","$second"],text:"Great, thanks for letting me know!",sleepAfter:0}],defaultResponses:[{text:"Okay, just let me know when you\u2019re ready.",sleepAfter:0}]},{sleepBefore:4,text:"With the items from this package you will need to find the names of 3 more potion ingredients (the snake, flower, and mushroom), the layout of the tunnels, and the location of the lab. You can work on finding all this information simultaneously, but I won\u2019t plan on going down to the tunnels until you have everything.",sleepAfter:1},{sleepBefore:4,text:" As I mentioned in the letter, I\u2019ll need your help to program navigation instructions into the bot since we don\u2019t know what the conditions are like down there. But first things first! Let me know the names of the 3 potion ingredients, one at a time.",waitFor:[{answers:["eryx"],text:"Great, you\u2019ve figured out which snake bone we need.",sleepAfter:0},{answers:["vantia"],text:"Excellent, now we know which flower to use.",sleepAfter:0},{answers:["agricosa"],text:"So that\u2019s the mushroom we\u2019re looking for! Good work.",sleepAfter:0}]},{sleepBefore:3,text:"Now that we know the 3 ingredients, have you used the map and the window images to figure out the tunnel layout and where the lab is located?",waitFor:[{answers:["$yes"],sleepAfter:0}],defaultResponses:[{text:"Okay, just let me know when you\u2019re ready."}]},{text:"Are you ready to help me navigate to the lab through the tunnels?",waitFor:[{answers:["$yes"]}],defaultResponses:[{text:"Okay, just let me know when you\u2019re ready."}]},{sleepBefore:4,text:"Excellent. Just remember that we will need to enter our instructions in the form of a numerical distance and cardinal direction (such as N for north, S for south, etc.) We will use the rosary beads as a scale for distance, so if you want me to go 7 beads west, for example, you can give me an instruction like 7W. I\u2019m going to head down from the cathedral now!",sleepAfter:3},{key:"locationOne",sleepBefore:4,text:"As soon as I get downstairs, there is a path east and a path south. Enter the number of units and either E or S for the direction. Keep in mind that if we don\u2019t find anything at a particular spot then the bot will just return to its previous position.",waitFor:[{answers:["7s","s7","7 south"],satisfies:!0},{answers:["e"],text:"It looks like there is nothing east of here, so let\u2019s go back to the entrance - let me know how far south I should go.",repeat:!0,sleepAfter:0}],defaultResponses:[{text:"It doesn\u2019t look like there is anything here. Let\u2019s return to the previous position and try again. Let me know the next direction when you\u2019re ready."}]},{key:"locationTwo",text:"Okay, I\u2019ve arrived at a four-way intersection and can go south, east, or west.",waitFor:[{answers:["13e","e13","13 east"],text:"Wow, this path goes pretty far, but I\u2019ve finally reached another intersection. I can go north, south, or keep going east.",satisfies:!0,goto:"locationFive",sleepAfter:0},{answers:["23e","e23","23 east"],text:"Alright, I\u2019ve gone as far east as I can go now, and I can either turn north or south.",satisfies:!0,goto:"locationEight",sleepAfter:0},{answers:["6w","7w","w6","w7","6 west","7 west"],text:"Wow, the tunnel gets really narrow down this way. I guess they didn\u2019t want too many people going down here\u2026 There is a room here with a lot of containers - boxes, chests, vessels - but they\u2019re all empty. I'll return to that 4-way interaction, and can try going east or south.",repeat:!0,sleepAfter:0},{answers:["9s","10s","s9","s10","10 south","9 south"],text:"Hmm... I see a room with a whole lot of armour and weaponry, but that seems to be all that's here. I\u2019m going to turn back to the previous intersection and can head east or west.",repeat:!0,sleepAfter:0}],defaultResponses:[{text:"It doesn\u2019t look like there is anything here. Let\u2019s return to the previous position and try again. Let me know the next direction when you\u2019re ready."}]},{key:"locationFive",waitFor:[{answers:["10e","e10","10 east"],text:"Alright, I\u2019ve gone as far east as I can go now, and I can either turn north or south.",satisfies:!0},{answers:["7s","8s","s7","s8","7 south","8 south"],text:"This is a really long path\u2026 we must be way past the city center at this point... I do see a big cellar full of barrels! I guess they used to store wine down here. I wonder if there\u2019s any still around\u2026 but that's for another time. I\u2019m going back to the intersection now, and can head east or north.",repeat:!0,sleepAfter:0},{answers:["3n","4n","n3","n4","3 north","4 north"],text:"I went north but hit a dead end pretty quickly... and it looks like someone else may have hit a dead end here too\u2026 I\u2019m going to go back to the intersection and can go east or south.",repeat:!0,sleepAfter:0}],defaultResponses:[{text:"It doesn\u2019t look like there is anything here. Let\u2019s return to the previous position and try again. Let me know the next direction when you\u2019re ready."}]},{key:"locationEight",waitFor:[{answers:["4n","5n","n4","n5","4 north","5 north"],satisfies:!0},{answers:["s"],text:"Oh no, this is a dead end! I\u2019m going to go back and try going north. Let me know how far to go.",repeat:!0,sleepAfter:0}],defaultResponses:[{text:"It doesn\u2019t look like there is anything here. Let\u2019s return to the previous position and try again. Let me know the next direction when you\u2019re ready."}]},{text:"Wow, I think this is it, I can\u2019t believe it! You've got to check out the view from the camera feed."},{image:{src:"./camfeed.jpg",description:"A camera feed of the lab."}},{text:"Thank you again for all your help, I could have never done it without you."},{text:"I\u2019m going to investigate in there and see what I can find. I\u2019m sure there will be a lot to go through, so you can expect another package soon with our findings. Get in touch with me when you open it, and in the meantime, be sure to get some rest, you\u2019ve earned it!"},{text:"Jesse Wright has left the chat. To begin a new session with this user please send a new message or refresh the page.",info:!0,waitForAnyInput:!0},{key:"march",month:["$march"],text:"Hi {name}, great to hear from you again. Did you receive the third package and are ready to continue?",waitFor:[{answers:["$yes","$third"],sleepBefore:2,text:"Great, I\u2019m happy to know you\u2019re still with us.",sleepAfter:0}],defaultResponses:[{sleepBefore:2,text:"Okay, just let me know when you\u2019re ready.",sleepAfter:0}]},{sleepBefore:4,text:"As mentioned in the letter, we need to find out the latitude and longitude of the next comet\u2019s appearance, how many hours it takes to prepare the potion, and under what phase of the moon it must be brewed... but let\u2019s hold off on the moon phase for now.",sleepAfter:2},{sleepBefore:4,text:"Once you figure out the coordinates of the next comet appearance, enter them one at a time in the format of 10N or 10S for the latitude, and 10E or 10W for the longitude. As for the brewing time, enter it in the format of \u201C3h\u201D or \u201C3 hours.\u201D",waitFor:[{answers:["14h","14hr","14 h","14 hr","14hrs","14 hrs","14hours","14 hour","14 hours"],sleepBefore:2,text:"14 hours? Wow. I guess that will be a very long and interesting night!",sleepAfter:0},{answers:["55n","n55","55 north"],sleepBefore:2,text:"You found the latitude! Great work.",sleepAfter:0},{answers:["5w","w5","5 west"],sleepBefore:2,text:"You found the longitude! Well done.",sleepAfter:0}],defaultResponses:[{sleepBefore:2,text:"Hmm, you should double check your work... and make sure your answer includes a number and a letter so that we're on the same page.",sleepAfter:0}]},{sleepBefore:3,text:"Thank you for helping us find the brew time and location! Now all we need to know is under what phase of the moon we should prepare the elixir.",sleepAfter:1},{sleepBefore:4,text:"Keep in mind that this step could potentially compromise everything we\u2019ve worked for. I realize that you may be skeptical of his plans, but Mr. Redmond has put his faith in you, and I hope you will not betray his trust.",sleepAfter:1},{key:"moonchoice",text:"Consider your answer carefully - our fate is in your hands.",waitFor:[{answers:["new"],sleepBefore:2,saveVariable:{moonPhase:"new"},sleepAfter:0,satisfies:!0},{answers:["full"],sleepBefore:2,saveVariable:{moonPhase:"full"},sleepAfter:0,satisfies:!0}],defaultResponses:[{sleepBefore:3,text:"That doesn\u2019t seem quite right. Historically, alchemists were known to brew their potions under a full or new moon.",sleepAfter:0}]},{sleepBefore:2,text:"Okay, then I should be off to begin preparations. Thank you again for all you have done.",sleepAfter:1},{sleepBefore:3,text:"Oh, I almost forgot! Our research partners at the Emerens Institute in Sweden have shared a letter from their archive with us. We thought you may be interested, so I\u2019ve mailed you a copy in a small envelope as a small token of our appreciation.",sleepAfter:1},{conditionals:[{variableEquals:["moonPhase","new"],text:"Things are about to get very busy, so I won\u2019t be online much, but keep an eye on our <a target='_tab' href='https://koscheisociety.org/whatsnew'>news page</a> for any updates:",link:{title:"What's new",href:"https://koscheisociety.org/whatsnew",img:{src:"./society.jpg",description:"The Koschei Society building"}}},{variableEquals:["moonPhase","full"],text:"Things are about to get very busy, so I won\u2019t be online much, but keep an eye on our <a target='_tab' href='https://koscheisociety.org/news'>news page</a> for any updates:",link:{title:"News",href:"https://koscheisociety.org/news",img:{src:"./society.jpg",description:"The Koschei Society building"}}}]},{text:"Until we speak again, take care of yourself."},{sleepBefore:0,info:!0,text:"Jesse Wright has left the chat. To begin a new chat session please refresh the page.",waitForAnyInput:!0,goto:"start"},{key:"april",month:["$april"],text:"Hello! I was hoping to hear from you\u2026 I imagine you must be getting in touch because you found something in the letter we sent you. I knew that if there was a hidden message you would be the one to find it. What does it say?",waitFor:[{answers:["meet me at lake vattern","where the ancient stags dash like the winds"],sleepBefore:4,text:"Well, that\u2019s certainly very interesting. Aside from the fact that Lake Vattern is in Sweden, I have no idea what that message is referring to... Yet another mystery to add to our collection, I suppose! I\u2019m sure we will be in touch if we find out anything else. Thank you again for your help. You\u2019ve truly been an invaluable part of this project. Until we speak again, take good care of yourself.",sleepAfter:0}]},{sleepBefore:2,info:!0,text:"Your chat session has ended. To begin a new session please refresh the page.",waitForAnyInput:!0,goto:"start"},{key:"may",month:["$may"],text:"Hello again! I knew we could count on you to figure out what to do with that strange box. Did you find out any information about the location of the alchemist at the time?",waitFor:[{answers:["sterjn"],sleepBefore:4,text:"Excellent work, as always. I knew I could count on you to figure this out. We\u2019re going to contact The Emerens Institute to find out if they have anything in their archives from that location. Thank you for your diligence.",sleepAfter:0}]},{sleepBefore:2,info:!0,text:"Your chat session has ended. To begin a new session please refresh the page.",waitForAnyInput:!0,goto:"start"},{key:"november",month:["$november"],text:"Hi {name}! Thanks for taking a look at that postcard, I knew you would be the right person to ask. What is the hidden message you found?",waitFor:[{answers:["cellar"],sleepBefore:4,text:"Wow, that\u2019s fantastic! We will go search the cellar and will send you our findings for inspection. Keep an eye out for more material from us next month. Thank you so much for your help!",sleepAfter:0}]},{sleepBefore:2,info:!0,text:"Your chat session has ended. To begin a new session please refresh the page.",waitForAnyInput:!0,goto:"start"},{key:"december",month:["$december"],text:"Hi {name}, nice to hear from you! I hope you were able to decipher the page with the hands that we sent you. What does it say?",waitFor:[{answers:["old town hall"],sleepBefore:4,text:"Amazing! I can tell you were made for this kind of work.",sleepAfter:0}]},{sleepBefore:2,text:"Well, the Town Hall is quite a big space, so we\u2019ve got a lot of searching ahead of us. If we discover anything there, I hope you\u2019ll be available to assist us with our findings. Thank you again for all your help!"},{sleepBefore:2,info:!0,text:"Your chat session has ended. To begin a new session please refresh the page.",waitForAnyInput:!0,goto:"start"}]},Tt=ce.variables,Bt=ce.bot,Et=ce.dialogue;const jt=Object.entries(Tt),Re=t=>JSON.parse(JSON.stringify(t),(e,n)=>{if(!Array.isArray(n))return n;let o=[...n];for(const[s,r]of jt){const i=o.indexOf(s);i!==-1&&(o.splice(i,1),o=[...o,...r])}return o}),Ft=/\s\s+/g,Lt=(t,e,n)=>{for(const[o,s]of e.entries())for(const r of s.answers){const i=new RegExp(`\\b(${r})\\b`,"i");if(t.replace(Ft," ").toLowerCase().trim().match(i))return s.repeat||e.splice(o,1),s.saveInputAs&&(n[s.saveInputAs]=r.toLowerCase(),s.saveInputAs=void 0),s}return!1};function Pe(t,e,n){const o=t.slice();return o[22]=e[n],o[24]=n,o}function He(t,e){let n,o,s;const r=[e[22]];let i={};for(let a=0;a<r.length;a+=1)i=ot(i,r[a]);return o=new qe({props:i}),{key:t,first:null,c(){n=at(),ne(o.$$.fragment),this.first=n},m(a,u){S(a,n,u),D(o,a,u),s=!0},p(a,u){e=a;const c=u&1?wt(r,[yt(e[22])]):{};o.$set(c)},i(a){s||(L(o.$$.fragment,a),s=!0)},o(a){O(o.$$.fragment,a),s=!1},d(a){a&&E(n),G(o,a)}}}function $e(t){let e,n;return e=new qe({props:{typing:!0}}),{c(){ne(e.$$.fragment)},m(o,s){D(e,o,s),n=!0},i(o){n||(L(e.$$.fragment,o),n=!0)},o(o){O(e.$$.fragment,o),n=!1},d(o){G(e,o)}}}function St(t){let e,n,o=[],s=new Map,r,i,a,u,c=t[0];const y=h=>h[24];for(let h=0;h<c.length;h+=1){let f=Pe(t,c,h),d=y(f);s.set(d,o[h]=He(d,f))}let l=t[1]&&$e();return a=new vt({}),a.$on("input",t[2]),{c(){e=I("main"),n=I("chat-messages");for(let h=0;h<o.length;h+=1)o[h].c();r=F(),l&&l.c(),i=F(),ne(a.$$.fragment),P(n,"class","flex grow flex-col gap-4 p-4"),b(e,"class","absolute top-0 left-0 w-screen h-[calc(100%-3rem)] flex flex-col overflow-y-auto bg-gray-100")},m(h,f){S(h,e,f),v(e,n);for(let d=0;d<o.length;d+=1)o[d].m(n,null);v(n,r),l&&l.m(n,null),v(e,i),D(a,e,null),u=!0},p(h,[f]){f&1&&(c=h[0],Be(),o=pt(o,f,y,1,h,c,s,n,gt,He,r,Pe),Ee()),h[1]?l?f&2&&L(l,1):(l=$e(),l.c(),L(l,1),l.m(n,null)):l&&(Be(),O(l,1,1,()=>{l=null}),Ee())},i(h){if(!u){for(let f=0;f<c.length;f+=1)L(o[f]);L(l),L(a.$$.fragment,h),u=!0}},o(h){for(let f=0;f<o.length;f+=1)O(o[f]);O(l),O(a.$$.fragment,h),u=!1},d(h){h&&E(e);for(let f=0;f<o.length;f+=1)o[f].d();l&&l.d(),G(a)}}}function Ot(t,e,n){let{env:o}=e,{bot:s}=e,{dialogue:r}=e,{debugJumpTo:i}=e,a=[],u=!1,c=!1,y=!1,l="",h={},f,d=0;const w=g=>{const{value:B}=g.detail;W({user:!0}),k(B),f?(f(B),f=void 0):l+=` ${B}`},p=()=>{if(l){const g=`${l}`;return l="",Promise.resolve(g)}return new Promise(g=>{f=g})},_=g=>{g[0]==="$"?(g=g.slice(1),d=r.findIndex(B=>{const R=B[g];return R&&typeof R=="object"&&Re(R).includes(h[g])})):d=r.findIndex(B=>B.key===g),y=!0},m=async g=>{const{text:B,image:R,info:Ue=!1,sleepBefore:Ke=s.sleepBefore,sleepAfter:Ye=s.sleepAfter,saveInputAs:de,saveVariable:me,waitFor:ge=[],conditionals:De=[],waitForAnyInput:Ge=!1,defaultResponses:pe=s.responses.incorrect,goto:we,link:ye}=Re(g);if((B||R)&&W({info:Ue,user:!1}),await We(o==="cypress"?0:Ke),B){let j=B;for(const[C,re]of Object.entries(h))j=j.replace(`{${C}}`,re);k(j)}for(R&&A(R),ye&&(W(),T(ye)),de&&(h[de]=await p()),Ge&&await p(),me&&(h=V(V({},h),me));ge.length>0;){const j=Lt(await p(),ge,h);if(j){if(await m(j),j.satisfies)break}else{const C=Math.random()*pe.length|0;await m(pe[C])}}for(const j of De){const{variableEquals:C}=j,[re,Ve]=C;if(h[re]===Ve){await m(j);break}}await We(o==="cypress"?0:Ye),we&&_(we)},x=async()=>{for(i&&(_(i),y=!1);d<r.length;)await m(r[d]),y?y=!1:d+=1},W=(g={})=>{if(c)throw new Error("message already pending");n(1,u=!g.user&&!g.info),a.push(V({value:"",datetime:Date.now()},g)),c=!0},N=()=>{a.pop()},k=g=>{n(0,a[a.length-1].value=g,a),n(1,u=!1),c=!1,n(0,a)},A=g=>{n(0,a[a.length-1].image=g,a),n(1,u=!1),n(0,a),c=!1},T=g=>{n(0,a[a.length-1].link=g,a),n(1,u=!1),n(0,a),c=!1};return x(),t.$$set=g=>{"env"in g&&n(3,o=g.env),"bot"in g&&n(4,s=g.bot),"dialogue"in g&&n(5,r=g.dialogue),"debugJumpTo"in g&&n(6,i=g.debugJumpTo)},[a,u,w,o,s,r,i,W,N,k,A]}class Mt extends se{constructor(e){super();oe(this,e,Ot,St,te,{env:3,bot:4,dialogue:5,debugJumpTo:6,startMessage:7,cancelMessage:8,commitMessage:9,commitImage:10})}get startMessage(){return this.$$.ctx[7]}get cancelMessage(){return this.$$.ctx[8]}get commitMessage(){return this.$$.ctx[9]}get commitImage(){return this.$$.ctx[10]}}function Wt(t){let e,n;return e=new Mt({props:{env:t[1],bot:Bt,dialogue:Et,debugJumpTo:t[0]}}),{c(){ne(e.$$.fragment)},m(o,s){D(e,o,s),n=!0},p:M,i(o){n||(L(e.$$.fragment,o),n=!0)},o(o){O(e.$$.fragment,o),n=!1},d(o){G(e,o)}}}function Rt(t){var o;const e=new URLSearchParams(window.location.search).get("debug"),n=(o=window.sessionStorage.getItem("env"))!=null?o:"";return[e,n]}class Pt extends se{constructor(e){super();oe(this,e,Rt,Wt,te,{})}}new Pt({target:document.querySelector("#app")});nt(()=>import("./analytics.f8044804.js"),[]);
